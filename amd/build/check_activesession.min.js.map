{"version":3,"file":"check_activesession.min.js","sources":["../src/check_activesession.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n// Project implemented by the \"Recovery, Transformation and Resilience Plan.\n// Funded by the European Union - Next GenerationEU\".\n//\n// Produced by the UNIMOODLE University Group: Universities of\n// Valladolid, Complutense de Madrid, UPV/EHU, León, Salamanca,\n// Illes Balears, Valencia, Rey Juan Carlos, La Laguna, Zaragoza, Málaga,\n// Córdoba, Extremadura, Vigo, Las Palmas de Gran Canaria y Burgos.\n\n/**\n *\n * @module    mod_jqshow/check_activesession\n * @copyright  2023 Proyecto UNIMOODLE\n * @author     UNIMOODLE Group (Coordinator) <direccion.area.estrategia.digital@uva.es>\n * @author     3IPUNT <contacte@tresipunt.com>\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\"use strict\";\n\nimport Ajax from 'core/ajax';\nimport Notification from 'core/notification';\n\nlet SERVICES = {\n    GETACTIVESESSION: 'mod_jqshow_getactivesession'\n};\n\nlet cmId;\nlet jqshowId;\n\n/**\n * @constructor\n * @param {int} cmid\n * @param {int} jqshowid\n */\nfunction CheckActiveSession(cmid, jqshowid) {\n    cmId = cmid;\n    jqshowId = jqshowid;\n    setInterval(this.checkActive, 5000);\n}\n\nCheckActiveSession.prototype.checkActive = function() {\n    let request = {\n        methodname: SERVICES.GETACTIVESESSION,\n        args: {\n            cmid: cmId,\n            jqshowid: jqshowId\n        }\n    };\n    Ajax.call([request])[0].done(function(response) {\n        if (response.active !== 0) {\n            let sessionUrl = new URL(M.cfg.wwwroot + '/mod/jqshow/session.php');\n            sessionUrl.searchParams.set('cmid', cmId);\n            sessionUrl.searchParams.set('sid', response.active);\n            window.location.href = sessionUrl.href;\n        }\n    }).fail(Notification.exception);\n};\n\nexport const checkActiveSession = (cmid, jqshowid) => {\n    return new CheckActiveSession(cmid, jqshowid);\n};\n"],"names":["_interopRequireDefault","obj","__esModule","default","Object","defineProperty","_exports","value","checkActiveSession","_ajax","_notification","cmId","jqshowId","SERVICES","CheckActiveSession","cmid","jqshowid","setInterval","this","checkActive","prototype","request","methodname","args","Ajax","call","done","response","active","sessionUrl","URL","M","cfg","wwwroot","searchParams","set","window","location","href","fail","Notification","exception"],"mappings":"4HAkC6C,SAAAA,uBAAAC,KAAAA,OAAAA,KAAAA,IAAAC,WAAAD,IAAAE,CAAAA,QAAAF,IAAA,CAHhCG,OAAAC,eAAAC,SAAA,aAAA,CAAAC,OAAA,IAAAD,SAAAE,wBAAA,EAEbC,MAAAT,uBAAAS,OACAC,cAAAV,uBAAAU,eAEA,IAIIC,KACAC,SALAC,0BACkB,8BAWtB,SAASC,mBAAmBC,KAAMC,UAC9BL,KAAOI,KACPH,SAAWI,SACXC,YAAYC,KAAKC,YAAa,IAClC,CAEAL,mBAAmBM,UAAUD,YAAc,WACvC,IAAIE,QAAU,CACVC,WAAYT,0BACZU,KAAM,CACFR,KAAMJ,KACNK,SAAUJ,WAGlBY,MAAAA,QAAKC,KAAK,CAACJ,UAAU,GAAGK,MAAK,SAASC,UAClC,GAAwB,IAApBA,SAASC,OAAc,CACvB,IAAIC,WAAa,IAAIC,IAAIC,EAAEC,IAAIC,QAAU,2BACzCJ,WAAWK,aAAaC,IAAI,OAAQxB,MACpCkB,WAAWK,aAAaC,IAAI,MAAOR,SAASC,QAC5CQ,OAAOC,SAASC,KAAOT,WAAWS,IACtC,CACH,IAAEC,KAAKC,cAAYrC,QAACsC,YAKvBnC,SAAAE,mBAFgC,SAACO,KAAMC,UACrC,OAAO,IAAIF,mBAAmBC,KAAMC,UACtC"}