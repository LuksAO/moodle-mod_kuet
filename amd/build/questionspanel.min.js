define("mod_jqshow/questionspanel",["exports","jquery","core/str","core/ajax","core/modal_factory","core/modal_events","core/templates","core/notification"],(function(_exports,_jquery,_str,_ajax,_modal_factory,_modal_events,_templates,_notification){function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.initQuestionsPanel=void 0,_jquery=_interopRequireDefault(_jquery),_ajax=_interopRequireDefault(_ajax),_modal_factory=_interopRequireDefault(_modal_factory),_modal_events=_interopRequireDefault(_modal_events),_templates=_interopRequireDefault(_templates),_notification=_interopRequireDefault(_notification);var cmId,ACTION_SELECTCATEGORY="#id_movetocategory",SERVICES_SELECTCATEGORY="mod_jqshow_selectquestionscategory",REGION_PANEL='[data-region="questions-panel"]',REGION_SELECTQUESTION=".select_question",REGION_CONTENTQUESTIONS='[data-region="content-question"]',REGION_LOADING='[data-region="overlay-icon-container"]',TEMPLATES_LOADING="core/overlay_loading",TEMPLATES_QUESTIONSFORSELECT="mod_jqshow/createsession/contentquestions";function QuestionsPanel(selector){this.node=(0,_jquery.default)(selector),this.node.attr("data-sid"),cmId=this.node.attr("data-cmid"),this.initPanel()}QuestionsPanel.prototype.node=null,QuestionsPanel.prototype.initPanel=function(){this.node.find(ACTION_SELECTCATEGORY).on("change",this.selectCategory.bind(this))},QuestionsPanel.prototype.selectCategory=function(e){e.preventDefault(),e.stopPropagation();var categoryKey=(0,_jquery.default)(e.currentTarget).val(),identifier=(0,_jquery.default)(REGION_CONTENTQUESTIONS);if((0,_jquery.default)(REGION_SELECTQUESTION+":checked").length>0){(0,_str.get_strings)([{key:"changecategory",component:"mod_jqshow"},{key:"changecategory_desc",component:"mod_jqshow"},{key:"confirm",component:"mod_jqshow"}]).then((function(langStrings){var title=langStrings[0],message=langStrings[1],buttonText=langStrings[2];return _modal_factory.default.create({title:title,body:message,type:_modal_factory.default.types.SAVE_CANCEL}).then((function(modal){return modal.setSaveButtonText(buttonText),modal.getRoot().on(_modal_events.default.save,(function(){_templates.default.render(TEMPLATES_LOADING,{visible:!0}).done((function(html){(0,_jquery.default)(REGION_PANEL).append(html)}));var request={methodname:SERVICES_SELECTCATEGORY,args:{categorykey:categoryKey,cmid:cmId}};_ajax.default.call([request])[0].done((function(response){var templateQuestions=TEMPLATES_QUESTIONSFORSELECT;_templates.default.render(templateQuestions,response).then((function(html,js){identifier.html(html),_templates.default.runTemplateJS(js),(0,_jquery.default)(REGION_LOADING).remove()})).fail(_notification.default.exception)}))})),modal.getRoot().on(_modal_events.default.hidden,(function(){modal.destroy()})),modal}))})).done((function(modal){modal.show()})).fail(_notification.default.exception)}else{_templates.default.render(TEMPLATES_LOADING,{visible:!0}).done((function(html){(0,_jquery.default)(REGION_PANEL).append(html)}));var request={methodname:SERVICES_SELECTCATEGORY,args:{categorykey:categoryKey,cmid:cmId}};_ajax.default.call([request])[0].done((function(response){var templateQuestions=TEMPLATES_QUESTIONSFORSELECT;_templates.default.render(templateQuestions,response).then((function(html,js){identifier.html(html),_templates.default.runTemplateJS(js),(0,_jquery.default)(REGION_LOADING).remove()})).fail(_notification.default.exception)}))}};_exports.initQuestionsPanel=function(selector){return new QuestionsPanel(selector)}}));

//# sourceMappingURL=questionspanel.min.js.map